<!-- templates/planificador.html -->
{% extends "base.html" %}

{% block title %}Planificador - FocusFit{% endblock %}

{% block extra_head %}
<style>
  .card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.15) !important;
  }
  
  .btn {
    border-radius: 8px;
    font-weight: 500;
    transition: all 0.2s ease;
  }
  
  .list-group-item {
    border-color: rgba(0,0,0,0.08);
    transition: background-color 0.2s ease;
  }
  
  .list-group-item:hover {
    background-color: rgba(0,0,0,0.02);
  }
  
  .badge {
    font-weight: 500;
    padding: 0.375rem 0.75rem;
    border-radius: 6px;
  }
  
  .activity-header {
    background: linear-gradient(135deg, #295bbe 0%, #4a90e2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
</style>
{% endblock %}

{% block content %}
<div class="text-center mb-4">
  <h2 class="activity-header fs-3 fw-bold mb-2">Planificador</h2>
  <p class="text-muted fs-6">Organiza y gestiona tus rutinas de estudio y ejercicio.</p>
</div>

<div class="row g-4 mb-4">
  <!-- Lista de actividades -->
  <div class="col-md-8">
    <div class="card border-0 shadow-sm h-100" style="transition: transform 0.2s ease, box-shadow 0.2s ease;">
      <div class="card-header text-white border-0 bg-primary" style="padding: 1.25rem;">
        <h5 class="mb-1 fw-semibold">Actividades de tus rutinas</h5>
        <small class="opacity-75">Vista general de todas tus actividades programadas</small>
      </div>
      <div class="card-body p-4">
        <div class="alert alert-info border-0 mb-4" style="background: linear-gradient(135deg, #e3f2fd 0%, #f1f8e9 100%);">
          <i class="fas fa-info-circle me-2"></i>
          Para marcar actividades como completadas, ve a <a href="{{ url_for('lista_diaria') }}" class="fw-semibold text-decoration-none">Lista Diaria</a>.
        </div>

        {% if lista_diaria %}
          <div class="activity-list">
            {% for item in lista_diaria %}
              <div class="activity-item border rounded-3 p-3 mb-3 {% if item.completado %}bg-light{% endif %}" style="border-color: rgba(0,0,0,0.08) !important;">
                <div class="d-flex justify-content-between align-items-start">
                  <div class="flex-grow-1">
                    <div class="d-flex align-items-center gap-2 mb-2">
                      <h6 class="mb-0 fw-semibold text-dark">{{ item.nombre_item }}</h6>
                      <span class="badge {{ 'bg-success' if item.completado else 'bg-secondary' }}">
                        {% if item.completado %}Completado{% else %}Pendiente{% endif %}
                      </span>
                    </div>
                    
                    <p class="text-muted mb-2">{{ item.titulo }}</p>
                    
                    <!-- Días de la semana -->
                    {% if item.dias %}
                    <div class="mb-2">
                      <small class="text-primary fw-semibold me-2">Días programados:</small>
                      {% set dias_map = {
                        'lunes': 'Lun', 'martes': 'Mar', 'miercoles': 'Mié', 'jueves': 'Jue', 
                        'viernes': 'Vie', 'sabado': 'Sáb', 'domingo': 'Dom'
                      } %}
                      {% for dia in item.dias.split(',') %}
                        <span class="badge bg-primary me-1">{{ dias_map.get(dia.strip().lower(), dia.strip()) }}</span>
                      {% endfor %}
                    </div>
                    {% endif %}
                    
                    <!-- Detalles de la actividad -->
                    <div class="d-flex flex-wrap gap-2 align-items-center">
                      {% if item.series %}
                        <span class="badge bg-light text-dark border">{{ item.series }} series</span>
                      {% endif %}
                      {% if item.repeticiones %}
                        <span class="badge bg-light text-dark border">{{ item.repeticiones }} rep</span>
                      {% endif %}
                      {% if item.tiempo %}
                        <span class="badge bg-light text-dark border">{{ item.tiempo }} min</span>
                      {% endif %}
                      {% if item.prioridad %}
                        <span class="badge bg-{{ 'danger' if item.prioridad == 'alta' else 'warning' if item.prioridad == 'media' else 'secondary' }}">
                          Prioridad {{ item.prioridad }}
                        </span>
                      {% endif %}
                    </div>
                  </div>
                </div>
              </div>
            {% endfor %}
          </div>
        {% else %}
          <div class="text-center py-5">
            <i class="fas fa-calendar-plus text-primary fa-3x mb-3 opacity-50"></i>
            <h6 class="text-muted mb-2">No hay actividades programadas</h6>
            <p class="text-muted mb-3">Crea tu primera rutina para empezar a organizar tus actividades</p>
            <a href="/crear_rutina" class="btn btn-primary btn-sm px-4">Crear tu primera rutina</a>
          </div>
        {% endif %}
      </div>
    </div>
  </div>

  <!-- Panel lateral: Rutinas -->
  <div class="col-md-4">
    <div class="card border-0 shadow-sm h-100" style="transition: transform 0.2s ease, box-shadow 0.2s ease;">
      <div class="card-header text-white border-0 bg-success" style="padding: 1.25rem;">
        <h5 class="mb-1 fw-semibold">Tus rutinas</h5>
        <small class="opacity-75">Gestiona y organiza tus rutinas</small>
      </div>
      <div class="card-body p-4">
        {% if rutinas %}
          <div class="rutinas-list mb-4">
            {% for r in rutinas %}
              <div class="d-flex justify-content-between align-items-center py-3 border-bottom border-light">
                <div class="flex-grow-1">
                  <h6 class="mb-1 fw-semibold text-dark">{{ r.nombre }}</h6>
                  <small class="text-muted">{{ r.descripcion or 'Sin descripción' }}</small>
                </div>
                <a href="{{ url_for('ver_rutina', id_rutina=r.id) }}" class="btn btn-sm btn-outline-success">Ver</a>
              </div>
            {% endfor %}
          </div>
        {% else %}
          <div class="text-center py-4 mb-4">
            <i class="fas fa-dumbbell text-success fa-2x mb-3 opacity-50"></i>
            <h6 class="text-muted mb-2">Sin rutinas creadas</h6>
            <p class="text-muted small">Comienza creando tu primera rutina</p>
          </div>
        {% endif %}

        <div class="d-grid gap-2">
          <a href="/crear_rutina?from=planificador" class="btn btn-success btn-sm">
            <i class="fas fa-plus me-2"></i>Nueva rutina
          </a>
          <a href="/mis_rutinas" class="btn btn-outline-success btn-sm">
            <i class="fas fa-list me-2"></i>Ver todas las rutinas
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}